rm(list = ls())
applicants=c(20.175, 7.101, 5.002, 18.107, 33.211, 33.736, 4.777, 20.923, 24.233, 9.679, 5.111, 20.756, 10.217, 73.782, 20.934, 28.518, 33.226, 24.988, 31.021, 5.465, 18.42, 10.394, 14.933, 8.832, 20.918, 31.941, 21.359, 10.04, 32.19, 10.332, 20.744, 30.629, 25.194, 36.362, 10.039, 10.991, 14.887, 13.799, 31.28, 11.552, 20.677, 7.532, 5.345, 16.125, 73.448, 16.958, 36.101, 86.537, 19.814, 38.785, 14.223, 28.662, 25.884, 5.713, 60.543, 26.496, 66.515, 12.92, 10.245, 44.76, 35.822, 7.075, 66.813, 20.443, 16.689, 13.758, 14.944, 39.896, 31.332, 3.542, 4.582, 49.776, 50.299, 40.727, 15.61)
applicants=log(applicants)
per.admit=c(53, 70, 84, 60, 66, 51, 63, 77, 73, 63, 76, 52, 60, 16, 74, 44, 50, 53, 29, 83, 80, 95, 76, 84, 56, 60, 75, 61, 71, 63, 73, 53, 68, 76, 42, 81, 82, 84, 50, 83, 72, 79, 93, 84, 33, 83, 58, 19, 51, 40, 77, 46, 33, 83, 40, 62, 37, 70, 61, 45, 59, 57, 36, 52, 76, 75, 66, 59, 28, 89, 85, 32, 50, 56, 64)
num.enroll=c(49.61, 15.829, 16.936, 20.655, 50.081, 36.047, 10.646, 16.571, 12.856, 20.517, 7.099, 21.857, 13.979, 37.565, 29.217, 16.695, 60.767, 41.938, 23.732, 15.805, 15.117, 20.626, 28.628, 19.934, 35.197, 48.378, 24.096, 18.647, 61.642, 11.314, 31.224, 28.617, 22.68, 46.416, 12.602, 31.515, 28.686, 14.982, 26.541, 11.286, 29.203, 19.507, 13.952, 29.477, 30.709, 25.912, 21.498, 41.845, 20.611, 51.313, 27.511, 49.459, 23.109, 14.747, 34.508, 37.485, 30.051, 30.69, 39.74, 51.147, 45.14, 10.725, 23.051, 33.989, 35.313, 30.848, 30.297, 39.752, 29.135, 10.061, 15.071, 43.625, 47.04, 17.866, 27.238)
stfacratio=c(26, 17, 17, 15, 17, 21, 17, 17, 15, 21, 13, 16, 19, 17, 18, 20, 31, 25, 15, 20, 19, 20, 23, 22, 18, 16, 19, 17, 20, 11, 16, 14, 15, 17, 23, 17, 15, 19, 16, 16, 18, 13, 18, 21, 19, 17, 19, 16, 15, 17, 18, 21, 18, 19, 18, 14, 19, 19, 26, 17, 19, 18, 17, 16, 18, 17, 24, 12, 13, 17, 19, 12, 17, 18, 19)
avg.grant=c(5.055, 8.591, 5.896, 9.097, 9.747, 10.736, 11.767, 9.507, 12.615, 5.421, 10.316, 8.684, 7.879, 16.425, 5.715, 6.838, 4.616, 5.976, 16.449, 5.826, 11.579, 7.338, 7.118, 5.462, 8.227, 10.726, 6.451, 7.937, 8.731, 9.924, 7.95, 10.461, 8.788, 8.834, 5.678, 6.726, 10.526, 4.582, 10.265, 7.719, 11.848, 7.576, 5.036, 6.229, 16.638, 8.901, 16.227, 17.423, 8.076, 8.727, 7.609, 6.05, 8.798, 4.89, 15.528, 7.327, 17.09, 7.959, 6.234, 7.511, 11.818, 7.745, 16.958, 9.322, 6.18, 7.736, 5.343, 9.322, 13.447, 4.412, 6.003, 14.671, 6.541, 17.287, 6.372)
grad.rate=c(49, 44, 34, 57, 79, 67, 54, 63, 76, 50, 66, 82, 61, 91, 63, 79, 65, 57, 93, 37, 78, 46, 28, 54, 79, 79, 67, 54, 80, 69, 83, 79, 80, 75, 45, 59, 67, 49, 82, 59, 58, 56, 49, 52, 86, 68, 66, 92, 54, 79, 58, 85, 79, 53, 81, 66, 86, 38, 40, 73, 84, 43, 80, 71, 62, 56, 41, 70, 89, 45, 47, 91, 86, 74, 53)
region=c('Southeast', 'West', 'GLNE', 'GLNE', 'GLNE', 'Southeast', 'Mid', 'GLNE', 'GLNE', 'Southeast', 'GLNE', 'Southeast', 'Mid', 'FarWest', 'GLNE', 'Mid', 'Southeast', 'Southeast', 'Southeast', 'Southeast', 'GLNE', 'GLNE', 'West', 'FarWest', 'Southeast', 'Mid', 'FarWest', 'Southeast', 'West', 'Mid', 'Southeast', 'Mid', 'Mid', 'GLNE', 'Southeast', 'West', 'FarWest', 'West', 'GLNE', 'GLNE', 'Southeast', 'FarWest', 'West', 'GLNE', 'FarWest', 'Southeast', 'FarWest', 'FarWest', 'GLNE', 'West', 'Southeast', 'Southeast', 'Southeast', 'Mid', 'FarWest', 'Mid', 'FarWest', 'GLNE', 'West', 'Mid', 'GLNE', 'Southeast', 'FarWest', 'Southeast', 'GLNE', 'Southeast', 'Southeast', 'GLNE', 'Southeast', 'Mid', 'West', 'GLNE', 'Mid', 'FarWest', 'Southeast')
univ = data.frame(applicants, per.admit, num.enroll, stfacratio, avg.grant, grad.rate, region) 
levels(univ$region)

# a
region <- relevel(univ$region, ref="FarWest")
regModel=lm(applicants ~ region + per.admit + num.enroll + stfacratio + avg.grant + grad.rate)
summary((regModel))

# b
region <- relevel(univ$region, ref="GLNE")
regModel=lm(applicants ~ region + per.admit + num.enroll + stfacratio + avg.grant + grad.rate)
summary((regModel))

# e
regModel=lm(applicants ~ region + per.admit + num.enroll + stfacratio + avg.grant + grad.rate + region*num.enroll)
summary((regModel))